#
# Mitigate Terrapin Attack
# https://terrapin-attack.com/
# https://access.redhat.com/security/cve/cve-2023-48795
#
# "etm@SSH" syntax too new and not yet supported on Rocky 9.3;
# use older and officially deprecated "ssh_etm" instead on 9.3.
# Older "ssh_etm" fails on 9.4, so there we use etm@SSH.
#
#ssh_etm = 0
cipher@SSH = -CHACHA20-POLY1305
etm@SSH = DISABLE_ETM

#
# Bugs in the LibreSSL implementation can result in Windows SSH clients using that broken LibreSSL version.
# to fail with "Corrupted MAC on input" or "message authentication code incorrect" errors. See
#     https://github.com/PowerShell/Win32-OpenSSH/issues/2078
#     https://github.com/libressl/portable/issues/603
# Workaround: Disable the use of the
#     umac-128*@openssh.com
# MAC algorithm on the server side to prevent any clients including those with bug in LibreSSL from using it.
# This basically forces all clients to use hmac-sha2-* instead.
# Note that this bug is only problematic when CHACHA20-POLY1305 is disabled to mitigate the Terrapin Attack.
#
mac@SSH = -UMAC-128*
